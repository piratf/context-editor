多环境支持的核心功能是先确认环境

## 环境层

插件加载后首先根据当前 vscode node 环境确认当前是什么环境。这个模块单例、轻量。并且提供公开只读接口供其他任何模块判断复用

### 多环境示例

在 windows 下会有多个环境的情况，因为用户一般启动的 vscode 都是 windows 环境，而开发者用户一般还会有一个或多个 wsl 环境。因此 windows 下会有访问 wsl 环境的需求。使用的路径格式为 `\\wsl$\<实例名称>\<Linux 内部路径>` 或者 `\\wsl.localhost\<实例名称>\<Linux 内部路径>`。检测 wsl 环境的方法需要轮询每个存在的 wsl 实例，只要有 home 目录下 .claude.json 就算。

在 wsl 下也会有多个环境的情况，如果用户启动了 wsl 版本的 vscode，同样应该检测 windows 环境下的配置。一个 wsl 环境的 vscode 实例无法访问其他 wsl 环境，因此 wsl 环境只需要额外处理一个 Windows 环境即可。

## .claude 配置搜索层

系统有几个可用环境，通过分析有几个 wsl 环境，并逐个检查每个环境下 $HOME/.claude.json 文件是否存在来实现，一旦存在，则将对应数据面加入列表。

## .claude.json 数据面

对于每个环境，.claude.json 是同样格式的。因此我们可以抽象出来一个数据面，提供基于 .claude.json 的数据查询服务。例如存在的项目列表。一个数据面，就是一个环境。后续所有的操作都围绕数据面接口进行。

多环境支持通过持有多个数据面来实现。

数据面是根据当前环境 + .claude.json 所在的环境实现的。实现由 .claude.json 配置解析层 + 环境路径层拼起来。例如 windows 下查询到某个 wsl 下存在 .claude.json 文件。此时调用 windowsParseWslClaudeSettingDataImpl。这个数据面对于返回项目路径函数特化处理，首先解析项目中 wsl 格式的路径，然后转换为 windows 访问 wsl 环境使用的路径格式。默认使用 `\\wsl.localhost\` 格式 (新格式)，如果不兼容则尝试 `\\wsl$\` 格式 (旧格式)。
如果是 wsl 访问 windows，对应的就是 wslParseWindowsClaudeSettingDataImpl。这个数据面就是一个 windows 配置解析层 + 一个 wsl 路径输出层。

每个数据面对上层提供统一接口，保证返回的路径对当前环境层直接可读。

### 环境解析层

例如 wsl 下的 .claude.json 配置。应该保存在 $HOME/.claude.json 路径。而 windows 下的 .claude.json 配置，应该保存在 %USERPROFILE%/.claude.json。

### 路径转换层

提供 WindowsToWslPath 和 WslToWindowsPath 等转换类。环境解析 + 路径转换层，组成了一个具体的 .claude.json 数据面。例如 windows 平台运行插件，检查到有 wsl 环境，调用 wsl 环境解析层，检查到有 .claude.json 文件，加入环境列表。然后构造数据面。此时数据面使用 wsl 环境解析曾 + WslToWindowsPath 路径转换层 (因为 vscode 环境层当前是 windows)。最终得到的数据面可以访问 wsl 环境配置，并返回 windows 可用路径。

## 渲染等其他功能组件

上层渲染等功能组件，从数据面接口获取必要的数据。